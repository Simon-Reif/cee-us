__import__:
    - "experiments/defaults.yaml"
    - "experiments/cee_us/settings/common/basic.yaml"

training_data_dir: "results/cee_us/construction/2blocks/gnn_ensemble_cee_us_freeplay/checkpoints_225"
working_dir: "results/cee_us/construction/2blocks/test_main_offline"
num_train_steps: 3_000_000
log_every_updates: 10_000
#used in lieu of num_eval_episodes to use gen_rollouts function
number_of_rollouts: 10

env: "FetchPickAndPlaceConstruction"
env_params:
  sparse: False
  shaped_reward: true
  num_blocks: 2
  stack_only: true
  case: "Singletower"
  visualize_target: true
  visualize_mocap: false

rollout_params:
  render: false
  render_initial: false
  render_eval: false
  record: false
  only_final_reward: false
  use_env_states: true
  logging: true
  task_horizon: 100

controller: "fb"
controller_params:
  compile: false
  cudagraphs: false
  model:
    inference_batch_size: 500_000
    actor_std: 0.2
    norm_obs: false
    seq_length: 1
    archi:
      z_dim: 100
      b:
        norm: true
        hidden_dim: 256
        hidden_layers: 2
      f:
        hidden_dim: 1024
        hidden_layers: 1
        model: "simple"  # {'simple', 'residual'}
        embedding_layers: 2
        num_parallel: 2
        ensemble_mode: "batch"  # {'batch', 'seq', 'vmap'}
      actor:
        hidden_dim: 1024
        hidden_layers: 1
        model: "simple"  # {'simple', 'residual'}
        embedding_layers: 2

  train:
    batch_size: 1024
    lr_f: 0.0001
    lr_actor: 0.0001
    lr_b: 0.0001
    ortho_coef: 1
    train_goal_ratio: 0.5
    actor_reg_coef: 0.01
    fb_pessimism_penalty: 0
    actor_pessimism_penalty: 0.5
    discount: 0.98
    weight_decay: 0.0
    clip_grad_norm: 0.0
    stddev_clip: 0.3
    q_loss_coef: 0.0

  
eval:
  #num_eval_episodes: 10 #->number_of_rollouts
  # number of samples to estimate zr
  num_inference_samples: 50_000
  eval_every_steps: 100_000
  # "cases" in env_params
  eval_tasks: ["Singletower", "PickAndPlace", "Flip", "Slide"]
  
device: "cuda:0"